# üîµ –ë–ª–æ–∫ 4: –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏ (Redis vs Memcached)

### 13. –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: Redis vs Memcached

–ù–∞ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–∏ —á–∞—Å—Ç–æ —Å–ø—Ä–∞—à–∏–≤–∞—é—Ç: *"–ü–æ—á–µ–º—É –ø–æ—á—Ç–∏ –≤—Å–µ –ø–µ—Ä–µ—à–ª–∏ –Ω–∞ Redis, –Ω–æ Memcached –≤—Å—ë –µ—â–µ –∂–∏–≤?"*

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞ | Memcached | Redis |
| --- | --- | --- |
| **–°—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö** | –¢–æ–ª—å–∫–æ **String** (Blob). –ß—Ç–æ–±—ã –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–ª–µ –≤ JSON, –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞—Ç—å –≤–µ—Å—å –æ–±—ä–µ–∫—Ç. | **String, Hash, List, Set, ZSet**. –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –ø–æ–ª—è, –¥–æ–±–∞–≤–ª—è—Ç—å —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Å–ø–∏—Å–∫–∏. |
| **–ü–æ—Ç–æ–∫–∏ (Threading)** | **Multithreaded**. –û—Ç–ª–∏—á–Ω–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ (–±–æ–ª—å—à–µ —è–¥–µ—Ä = –±–æ–ª—å—à–µ RPS). | **Single-threaded***. –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –æ–¥–Ω–æ–º —è–¥—Ä–µ. –ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –≥–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–æ (–∫–ª–∞—Å—Ç–µ—Ä). |
| **–ü–µ—Ä—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** | **–ù–µ—Ç**. –†–µ—Å—Ç–∞—Ä—Ç = –ø—É—Å—Ç–æ–π –∫—ç—à. | **–î–∞** (RDB —Å–Ω–∏–º–∫–∏, AOF –ª–æ–≥–∏). –ü–µ—Ä–µ–∂–∏–≤–∞–µ—Ç —Ä–µ—Å—Ç–∞—Ä—Ç. |
| **–†–µ–ø–ª–∏–∫–∞—Ü–∏—è** | –ù–µ—Ç. | –î–∞ (Master-Slave, Sentinel, Cluster). |
| **Lua-—Å–∫—Ä–∏–ø—Ç—ã** | –ù–µ—Ç. | –î–∞ (–ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–∞—Ç—å —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏). |

**–ö–æ–≥–¥–∞ –±—Ä–∞—Ç—å Memcached –≤ 2024?**
–¢–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤–∞–º –Ω—É–∂–µ–Ω **—Ç—É–ø–æ–π, —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω–æ –±—ã—Å—Ç—Ä—ã–π –∫—ç—à** –¥–ª—è –ø—Ä–æ—Å—Ç—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, HTML-–∫—É—Å–∫–∏ —Å—Ç—Ä–∞–Ω–∏—Ü), –∏ —É –≤–∞—Å –µ—Å—Ç—å –º–æ—â–Ω—ã–µ –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–Ω—ã–µ —Å–µ—Ä–≤–µ—Ä—ã, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã —Ö–æ—Ç–∏—Ç–µ —É—Ç–∏–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ 100% –æ–¥–Ω–∏–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º. –í 99% —Å–ª—É—á–∞–µ–≤ Redis –ª—É—á—à–µ.

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 6.0, Redis —É–º–µ–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø–æ—Ç–æ–∫–∏ –¥–ª—è —Å–µ—Ç–µ–≤–æ–≥–æ I/O, –Ω–æ –∏—Å–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥ –≤—Å–µ —Ä–∞–≤–Ω–æ –æ–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–æ–µ.*

---

### 14. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö Redis –∏ —Ä–µ–∞–ª—å–Ω—ã–µ –∫–µ–π—Å—ã

Redis –Ω–∞–∑—ã–≤–∞—é—Ç "—à–≤–µ–π—Ü–∞—Ä—Å–∫–∏–º –Ω–æ–∂–æ–º". –í–∞–∂–Ω–æ –∑–Ω–∞—Ç—å, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏.

1. **String (–°—Ç—Ä–æ–∫–∏):**
* *–°—É—Ç—å:* –û–±—ã—á–Ω—ã–π Key-Value.
* *–ö–µ–π—Å:* –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ HTML, —Å–µ—Å—Å–∏–∏, JSON-–æ–±—ä–µ–∫—Ç—ã, —Å—á–µ—Ç—á–∏–∫–∏ (`INCR`).


2. **List (–°–ø–∏—Å–∫–∏):**
* *–°—É—Ç—å:* –î–≤—É—Å–≤—è–∑–Ω—ã–π —Å–ø–∏—Å–æ–∫. –í—Å—Ç–∞–≤–∫–∞ –≤ –Ω–∞—á–∞–ª–æ/–∫–æ–Ω–µ—Ü –∑–∞ O(1).
* *–ö–µ–π—Å:* –û—á–µ—Ä–µ–¥–∏ –∑–∞–¥–∞—á (Celery –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Redis List), –ª–µ–Ω—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–±—ã—Ç–∏–π ("–ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∫–æ–º–º–µ–Ω—Ç–æ–≤").


3. **Hash (–•–µ—à–∏):**
* *–°—É—Ç—å:* "Map –≤–Ω—É—Ç—Ä–∏ Map".
* *–ö–µ–π—Å:* –ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ú–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å `HSET user:1 age 25` –±–µ–∑ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ –∏–º–µ–Ω–∏ –∏ email. –≠–∫–æ–Ω–æ–º–∏—Ç –ø–∞–º—è—Ç—å –ø–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—é —Å JSON-—Å—Ç—Ä–æ–∫–æ–π.


4. **Set (–ú–Ω–æ–∂–µ—Å—Ç–≤–∞):**
* *–°—É—Ç—å:* –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è, –Ω–µ—É–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ.
* *–ö–µ–π—Å:* –°–ø–∏—Å–æ–∫ IP-–∞–¥—Ä–µ—Å–æ–≤ (—É–±—Ä–∞—Ç—å –¥—É–±–ª–∏), —Ç–µ–≥–∏, "–û–±—â–∏–µ –¥—Ä—É–∑—å—è" (—á–µ—Ä–µ–∑ `SINTER` ‚Äî –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤).


5. **Sorted Set (ZSET / –£–ø–æ—Ä—è–¥–æ—á–µ–Ω–Ω—ã–µ –º–Ω–æ–∂–µ—Å—Ç–≤–∞):**
* *–°—É—Ç—å:* –ú–Ω–æ–∂–µ—Å—Ç–≤–æ + "–í–µ—Å" (Score). –í—Å–µ–≥–¥–∞ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–æ –ø–æ –≤–µ—Å—É.
* *–ö–µ–π—Å:* **–õ–∏–¥–µ—Ä–±–æ—Ä–¥—ã** (–¢–æ–ø –∏–≥—Ä–æ–∫–æ–≤), –æ—á–µ—Ä–µ–¥–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º, –æ—Ç–ª–æ–∂–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏ (–≥–¥–µ Score = timestamp –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è), Rate Limiting (Sliding Window).


6. **Bitmap (–ë–∏—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã):**
* *–°—É—Ç—å:* –ú–∞—Å—Å–∏–≤ –±–∏—Ç–æ–≤ (0/1). –û—á–µ–Ω—å –∫–æ–º–ø–∞–∫—Ç–Ω–æ.
* *–ö–µ–π—Å:* User Online Status (ID —é–∑–µ—Ä–∞ = —Å–º–µ—â–µ–Ω–∏–µ –±–∏—Ç–∞), –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ DAU/MAU. 100 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞–π–º—É—Ç –≤—Å–µ–≥–æ ~12 –ú–± –ø–∞–º—è—Ç–∏.



---

### 15. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Single-threaded (–û–¥–Ω–æ–ø–æ—Ç–æ—á–Ω–∞—è)

**–ü–æ—á–µ–º—É Redis —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ –æ–¥–Ω–æ–º –ø–æ—Ç–æ–∫–µ?**
–ß—Ç–æ–±—ã –±—ã—Ç—å **–ø—Ä–æ—Å—Ç—ã–º –∏ –±—ã—Å—Ç—Ä—ã–º**.

* –ù–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞ (Context Switch).
* –ù–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ (Locks) –≤–Ω—É—Ç—Ä–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–µ –Ω—É–∂–Ω–æ –∂–¥–∞—Ç—å, –ø–æ–∫–∞ –¥—Ä—É–≥–æ–π –ø–æ—Ç–æ–∫ –æ—Å–≤–æ–±–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã–µ).
* –ù–µ—Ç –≥–æ–Ω–æ–∫ (Race Conditions) –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥—ã. –û–ø–µ—Ä–∞—Ü–∏–∏ **–∞—Ç–æ–º–∞—Ä–Ω—ã**.

**–ì–ª–∞–≤–Ω—ã–π —Ä–∏—Å–∫:**
–¢–∞–∫ –∫–∞–∫ –ø–æ—Ç–æ–∫ –æ–¥–∏–Ω, –æ–Ω –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã **–ø–æ –æ—á–µ—Ä–µ–¥–∏**.
–ï—Å–ª–∏ –≤—ã –∑–∞–ø—É—Å—Ç–∏—Ç–µ "—Ç—è–∂–µ–ª—É—é" –∫–æ–º–∞–Ω–¥—É, –Ω–∞–ø—Ä–∏–º–µ—Ä `KEYS *` (–Ω–∞–π—Ç–∏ –≤—Å–µ –∫–ª—é—á–∏) –∏–ª–∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –Ω–∞ –º–∏–ª–ª–∏–æ–Ω —ç–ª–µ–º–µ–Ω—Ç–æ–≤, **Redis "–∑–∞–≤–∏—Å–Ω–µ—Ç"**.
–û–Ω –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –í–°–ï–ú –∫–ª–∏–µ–Ω—Ç–∞–º –Ω–∞ 1-2 —Å–µ–∫—É–Ω–¥—ã, –ø–æ–∫–∞ –Ω–µ –∑–∞–∫–æ–Ω—á–∏—Ç —ç—Ç—É –æ–ø–µ—Ä–∞—Ü–∏—é.

**–í—ã–≤–æ–¥ –¥–ª—è –ø—Ä–æ–¥–∞–∫—à–µ–Ω–∞:**
–ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—ã —Å–æ —Å–ª–æ–∂–Ω–æ—Å—Ç—å—é **O(N)** (–∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö) –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `SCAN` –≤–º–µ—Å—Ç–æ `KEYS`, `UNLINK` –≤–º–µ—Å—Ç–æ `DEL` (–¥–ª—è –±–æ–ª—å—à–∏—Ö –∫–ª—é—á–µ–π).

---