# ğŸ”´ Ğ‘Ğ»Ğ¾Ğº 2: ĞŸÑ€Ğ¾Ğ±Ğ»ĞµĞ¼Ñ‹, Ğ¡Ğ±Ğ¾Ğ¸ Ğ¸ Ğ¡Ñ‚Ğ°Ğ±Ğ¸Ğ»ÑŒĞ½Ğ¾ÑÑ‚ÑŒ

### 4. Cache Avalanche (Ğ›Ğ°Ğ²Ğ¸Ğ½Ğ° ĞºÑÑˆĞ°)

**Ğ¡Ğ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ:**
Ğ’Ñ‹ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·Ğ¸Ğ»Ğ¸ Ğ½Ğ° ÑĞ°Ğ¹Ñ‚ ĞºĞ°Ñ‚Ğ°Ğ»Ğ¾Ğ³ Ğ¸Ğ· 100 000 Ñ‚Ğ¾Ğ²Ğ°Ñ€Ğ¾Ğ² Ğ¸ Ğ²ÑĞµĞ¼ Ğ²Ñ‹ÑÑ‚Ğ°Ğ²Ğ¸Ğ»Ğ¸ `TTL = 60 Ğ¼Ğ¸Ğ½ÑƒÑ‚`.
Ğ Ğ¾Ğ²Ğ½Ğ¾ Ñ‡ĞµÑ€ĞµĞ· Ñ‡Ğ°Ñ, ÑĞµĞºÑƒĞ½Ğ´Ğ° Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ, Ğ²ÑĞµ ÑÑ‚Ğ¸ 100 000 ĞºĞ»ÑÑ‡ĞµĞ¹ Ğ¸ÑÑ‡ĞµĞ·Ğ½ÑƒÑ‚ Ğ¸Ğ· Redis.
ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸ Ğ¿Ñ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ°ÑÑ‚ Ğ·Ğ°Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ Ğ½Ğ° ÑĞ°Ğ¹Ñ‚. Ğ¢Ñ‹ÑÑÑ‡Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² Ğ¾Ğ±Ğ½Ğ°Ñ€ÑƒĞ¶Ğ¸Ğ²Ğ°ÑÑ‚, Ñ‡Ñ‚Ğ¾ ĞºÑÑˆĞ° Ğ½ĞµÑ‚, Ğ¸ **Ğ¾Ğ´Ğ½Ğ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾** Ğ¸Ğ´ÑƒÑ‚ Ğ² Ğ±Ğ°Ğ·Ñƒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….

**Ğ ĞµĞ·ÑƒĞ»ÑŒÑ‚Ğ°Ñ‚:**
Ğ ĞµĞ·ĞºĞ¸Ğ¹ ÑĞºĞ°Ñ‡Ğ¾Ğº Ğ½Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞ¸ (CPU/IO) Ğ½Ğ° Ğ‘Ğ”. Ğ‘Ğ°Ğ·Ğ° Ğ¿Ğ°Ğ´Ğ°ĞµÑ‚, ÑĞ°Ğ¹Ñ‚ Ğ»ĞµĞ¶Ğ¸Ñ‚ (502 Error).

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**

1. **Jitter (Ğ”Ñ€Ğ¾Ğ¶Ğ°Ğ½Ğ¸Ğµ/Ğ Ğ°Ğ·Ğ±Ñ€Ğ¾Ñ):** ĞĞ¸ĞºĞ¾Ğ³Ğ´Ğ° Ğ½Ğµ ÑÑ‚Ğ°Ğ²ÑŒÑ‚Ğµ Ñ€Ğ¾Ğ²Ğ½Ñ‹Ğ¹ TTL Ğ´Ğ»Ñ Ğ¿Ğ°Ñ‡ĞºĞ¸ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ….
* ĞŸĞ»Ğ¾Ñ…Ğ¾: `TTL = 3600 sec`
* Ğ¥Ğ¾Ñ€Ğ¾ÑˆĞ¾: `TTL = 3600 + random(0...300) sec`.
Ğ¢Ğ¾Ğ³Ğ´Ğ° ĞºĞ»ÑÑ‡Ğ¸ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ¿Ñ€Ğ¾Ñ‚ÑƒÑ…Ğ°Ñ‚ÑŒ Ğ¿Ğ»Ğ°Ğ²Ğ½Ğ¾, Ğ¸ Ğ±Ğ°Ğ·Ğ° Ğ±ÑƒĞ´ĞµÑ‚ ÑƒÑĞ¿ĞµĞ²Ğ°Ñ‚ÑŒ Ğ¸Ñ… Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ÑÑ‚ÑŒ.

---

### 5. Cache Penetration (ĞŸÑ€Ğ¾Ğ±Ğ¸Ñ‚Ğ¸Ğµ ĞºÑÑˆĞ°)

**Ğ¡Ğ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ:**
Ğ—Ğ»Ğ¾ÑƒĞ¼Ñ‹ÑˆĞ»ĞµĞ½Ğ½Ğ¸Ğº (Ğ¸Ğ»Ğ¸ Ğ¾ÑˆĞ¸Ğ±ĞºĞ° Ğ² ÑĞºÑ€Ğ¸Ğ¿Ñ‚Ğµ) Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°ĞµÑ‚ Ğ·Ğ°Ğ¿Ñ€Ğ°ÑˆĞ¸Ğ²Ğ°Ñ‚ÑŒ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ, ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… **Ğ½Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚** Ğ² Ğ¿Ñ€Ğ¸Ñ€Ğ¾Ğ´Ğµ.
ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€: `GET /user/-1` Ğ¸Ğ»Ğ¸ `GET /product/uuid-ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ³Ğ¾-Ğ½ĞµÑ‚`.

**Ğ¦Ğ¸ĞºĞ» ÑĞ¼ĞµÑ€Ñ‚Ğ¸:**

1. ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ´ĞµÑ‚ Ğ² ĞšÑÑˆ -> **Miss** (Ğ¿ÑƒÑÑ‚Ğ¾).
2. ĞŸÑ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğµ Ğ¸Ğ´ĞµÑ‚ Ğ² Ğ‘Ğ” -> **Empty** (Ñ‚Ğ¾Ğ¶Ğµ Ğ¿ÑƒÑÑ‚Ğ¾).
3. Ğ Ğ°Ğ· Ğ² Ğ‘Ğ” Ğ¿ÑƒÑÑ‚Ğ¾, Ğ¼Ñ‹ Ğ¾Ğ±Ñ‹Ñ‡Ğ½Ğ¾ *Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾ Ğ½Ğµ Ğ¿Ğ¸ÑˆĞµĞ¼ Ğ² ĞºÑÑˆ*.
4. Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğ¹ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¿Ğ¾ ÑÑ‚Ğ¾Ğ¼Ñƒ Ğ¶Ğµ ID ÑĞ½Ğ¾Ğ²Ğ° Ğ·Ğ°ÑÑ‚Ğ°Ğ²Ğ¸Ñ‚ Ğ½Ğ°Ñ Ğ¸Ğ´Ñ‚Ğ¸ Ğ² Ğ‘Ğ”.
5. Ğ•ÑĞ»Ğ¸ Ñ‚Ğ°ĞºĞ¸Ñ… Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ² 10 000 Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ â€” Ğ±Ğ°Ğ·Ğ° Ğ»ÑĞ¶ĞµÑ‚, Ğ¾Ğ±Ñ€Ğ°Ğ±Ğ°Ñ‚Ñ‹Ğ²Ğ°Ñ "Ğ¿ÑƒÑÑ‚Ğ¾Ñ‚Ñƒ".

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**

1. **ĞšÑÑˆĞ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ NULL (Cache Null Values):**
Ğ•ÑĞ»Ğ¸ Ğ±Ğ°Ğ·Ğ° Ğ²ĞµÑ€Ğ½ÑƒĞ»Ğ° "Ğ½Ğ¸Ñ‡ĞµĞ³Ğ¾", Ğ·Ğ°Ğ¿Ğ¸ÑˆĞ¸Ñ‚Ğµ Ğ² Redis ĞºĞ»ÑÑ‡ `product:uuid:empty` ÑĞ¾ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸ĞµĞ¼ `NULL` Ğ¸ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¼ TTL (Ğ½Ğ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, 5 Ğ¼Ğ¸Ğ½ÑƒÑ‚).
Ğ¢ĞµĞ¿ĞµÑ€ÑŒ ÑĞ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑÑ‹ ÑƒĞ¿Ñ€ÑƒÑ‚ÑÑ Ğ² ĞºÑÑˆ Ğ¸ Ğ¿Ğ¾Ğ»ÑƒÑ‡Ğ°Ñ‚ Ğ±Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ Ğ¾Ñ‚Ğ²ĞµÑ‚ "Ğ½Ğµ Ğ½Ğ°Ğ¹Ğ´ĞµĞ½Ğ¾".
2. **Bloom Filter (Ğ¤Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ‘Ğ»ÑƒĞ¼Ğ°):**
Ğ­Ñ‚Ğ¾ ĞºĞ¾Ğ¼Ğ¿Ğ°ĞºÑ‚Ğ½Ğ°Ñ ÑÑ‚Ñ€ÑƒĞºÑ‚ÑƒÑ€Ğ° Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ…, ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ°Ñ ÑÑ‚Ğ¾Ğ¸Ñ‚ *Ğ¿ĞµÑ€ĞµĞ´* ĞºÑÑˆĞµĞ¼. ĞĞ½Ğ° Ñ Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ 100% ÑĞºĞ°Ğ¶ĞµÑ‚, ĞµÑĞ»Ğ¸ ĞºĞ»ÑÑ‡Ğ° **Ñ‚Ğ¾Ñ‡Ğ½Ğ¾ Ğ½ĞµÑ‚**. Ğ•ÑĞ»Ğ¸ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ñ‚ "Ğ½ĞµÑ‚", Ğ¼Ñ‹ Ğ´Ğ°Ğ¶Ğµ Ğ½Ğµ Ğ¸Ğ´ĞµĞ¼ Ğ² Redis/Ğ‘Ğ”.

---

### 6. Cache Stampede (Thundering Herd / Dogpile / Ğ”Ğ°Ğ²ĞºĞ°)

**Ğ¡Ğ¸Ñ‚ÑƒĞ°Ñ†Ğ¸Ñ:**
Ğ’ Ğ¾Ñ‚Ğ»Ğ¸Ñ‡Ğ¸Ğµ Ğ¾Ñ‚ "Ğ›Ğ°Ğ²Ğ¸Ğ½Ñ‹" (Ğ³Ğ´Ğµ Ğ¼Ğ½Ğ¾Ğ³Ğ¾ ĞºĞ»ÑÑ‡ĞµĞ¹), Ğ·Ğ´ĞµÑÑŒ Ğ¿Ñ€Ğ¾Ğ±Ğ»ĞµĞ¼Ğ° Ñ **Ğ¾Ğ´Ğ½Ğ¸Ğ¼**, Ğ½Ğ¾ Ğ¾Ñ‡ĞµĞ½ÑŒ Ğ¿Ğ¾Ğ¿ÑƒĞ»ÑÑ€Ğ½Ñ‹Ğ¼ ("Ğ³Ğ¾Ñ€ÑÑ‡Ğ¸Ğ¼") ĞºĞ»ÑÑ‡Ğ¾Ğ¼. ĞĞ°Ğ¿Ñ€Ğ¸Ğ¼ĞµÑ€, "Ğ“Ğ»Ğ°Ğ²Ğ½Ğ°Ñ Ğ½Ğ¾Ğ²Ğ¾ÑÑ‚ÑŒ Ğ´Ğ½Ñ" Ğ¸Ğ»Ğ¸ "ĞšÑƒÑ€Ñ Ğ´Ğ¾Ğ»Ğ»Ğ°Ñ€Ğ°".

1. ĞšĞ»ÑÑ‡ Ñ‡Ğ¸Ñ‚Ğ°ÑÑ‚ 1000 Ñ€Ğ°Ğ· Ğ² ÑĞµĞºÑƒĞ½Ğ´Ñƒ.
2. Ğ’ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ `T` Ğ¸ÑÑ‚ĞµĞºĞ°ĞµÑ‚ ĞµĞ³Ğ¾ TTL.
3. Ğ’ Ğ¼Ğ¾Ğ¼ĞµĞ½Ñ‚ `T + 1Ğ¼Ñ` Ğ¿Ñ€Ğ¸Ñ…Ğ¾Ğ´ÑÑ‚ 500 Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹.
4. Ğ’ÑĞµ 500 Ğ²Ğ¸Ğ´ÑÑ‚, Ñ‡Ñ‚Ğ¾ ĞºÑÑˆĞ° Ğ½ĞµÑ‚.
5. Ğ’ÑĞµ 500 **Ğ¿Ğ°Ñ€Ğ°Ğ»Ğ»ĞµĞ»ÑŒĞ½Ğ¾** Ğ·Ğ°Ğ¿ÑƒÑĞºĞ°ÑÑ‚ Ñ‚ÑĞ¶ĞµĞ»Ñ‹Ğ¹ Ğ¿Ñ€Ğ¾Ñ†ĞµÑÑ Ğ¿ĞµÑ€ĞµÑÑ‡ĞµÑ‚Ğ° (Ğ¸Ğ´ÑƒÑ‚ Ğ² Ğ‘Ğ”, Ğ´ĞµĞ»Ğ°ÑÑ‚ join-Ñ‹).
6. Ğ‘Ğ°Ğ·Ğ° Ğ¿ĞµÑ€ĞµĞ³Ñ€ÑƒĞ¶ĞµĞ½Ğ° Ğ¾Ğ´Ğ¸Ğ½Ğ°ĞºĞ¾Ğ²Ñ‹Ğ¼Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ°Ğ¼Ğ¸.

**Ğ ĞµÑˆĞµĞ½Ğ¸Ğµ:**

1. **Mutex (Ğ’Ğ·Ğ°Ğ¸Ğ¼Ğ½Ğ°Ñ Ğ±Ğ»Ğ¾ĞºĞ¸Ñ€Ğ¾Ğ²ĞºĞ°):**
ĞŸĞµÑ€ĞµĞ´ Ñ‚ĞµĞ¼ ĞºĞ°Ğº Ğ¸Ğ´Ñ‚Ğ¸ Ğ² Ğ±Ğ°Ğ·Ñƒ, Ğ¿Ğ¾Ñ‚Ğ¾Ğº Ğ¿Ñ‹Ñ‚Ğ°ĞµÑ‚ÑÑ Ğ²Ğ·ÑÑ‚ÑŒ "Ğ»Ğ¾Ğº" Ğ² Redis (`SETNX lock:news:1`).
* *ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ* Ğ²Ğ·ÑĞ» Ğ»Ğ¾Ğº -> Ğ¸Ğ´ĞµÑ‚ Ğ² Ğ±Ğ°Ğ·Ñƒ.
* *ĞŸĞ¾Ñ‚Ğ¾ĞºĞ¸ Ğ‘, Ğ’, Ğ“* Ğ½Ğµ ÑĞ¼Ğ¾Ğ³Ğ»Ğ¸ Ğ²Ğ·ÑÑ‚ÑŒ Ğ»Ğ¾Ğº -> Ğ¶Ğ´ÑƒÑ‚ 50Ğ¼Ñ Ğ¸ Ğ¿Ñ€Ğ¾Ğ±ÑƒÑÑ‚ ÑĞ½Ğ¾Ğ²Ğ° Ğ¿Ñ€Ğ¾Ñ‡Ğ¸Ñ‚Ğ°Ñ‚ÑŒ Ğ¸Ğ· ĞºÑÑˆĞ° (Ğº ÑÑ‚Ğ¾Ğ¼Ñƒ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ ĞŸĞ¾Ñ‚Ğ¾Ğº Ğ ÑƒĞ¶Ğµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ).


2. **Probabilistic Early Expiration (Ğ’ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚Ğ½Ğ¾Ğµ Ñ€Ğ°Ğ½Ğ½ĞµĞµ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ¸Ğµ):**
Ğ’ ĞºĞ¾Ğ´Ğµ Ğ¼Ñ‹ Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼: ĞµÑĞ»Ğ¸ Ğ´Ğ¾ ĞºĞ¾Ğ½Ñ†Ğ° Ğ¶Ğ¸Ğ·Ğ½Ğ¸ ĞºĞ»ÑÑ‡Ğ° Ğ¾ÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ Ğ¼Ğ°Ğ»Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸, Ğ¾Ğ´Ğ¸Ğ½ Ğ¸Ğ· Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ñ Ğ½ĞµĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ Ğ²ĞµÑ€Ğ¾ÑÑ‚Ğ½Ğ¾ÑÑ‚ÑŒÑ Ğ¾Ğ±Ğ½Ğ¾Ğ²Ğ¸Ñ‚ ĞµĞ³Ğ¾ **Ğ·Ğ°Ñ€Ğ°Ğ½ĞµĞµ**, Ğ´Ğ¾ Ñ‚Ğ¾Ğ³Ğ¾ ĞºĞ°Ğº Ğ¾Ğ½ Ñ€ĞµĞ°Ğ»ÑŒĞ½Ğ¾ Ğ¿Ñ€Ğ¾Ñ‚ÑƒÑ…Ğ½ĞµÑ‚.

---

**Ğ ĞµĞ·ÑĞ¼Ğµ Ğ´Ğ»Ñ ÑĞ¾Ğ±ĞµÑĞµĞ´Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ:**

* **Avalanche** = ĞœĞ½Ğ¾Ğ³Ğ¾ ĞºĞ»ÑÑ‡ĞµĞ¹ Ğ¿Ñ€Ğ¾Ñ‚ÑƒÑ…Ğ»Ğ¸ Ñ€Ğ°Ğ·Ğ¾Ğ¼ -> **Jitter**.
* **Penetration** = Ğ—Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ½ĞµÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒÑÑ‰Ğ¸Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… -> **Cache NULL**.
* **Stampede** = Ğ’ÑĞµ Ğ»Ğ¾Ğ¼ÑÑ‚ÑÑ Ğ·Ğ° Ğ¾Ğ´Ğ½Ğ¸Ğ¼ ĞºĞ»ÑÑ‡Ğ¾Ğ¼ -> **Mutex**.
